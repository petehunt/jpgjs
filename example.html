<!DOCTYPE html>
<!-- Any copyright is dedicated to the Public Domain.
   - http://creativecommons.org/publicdomain/zero/1.0/ -->
<html>
<head>
<script src="jpgui.js"></script>
<script>

  var loader = new ImageLoader();

  function getCanvas() {
    return document.getElementById('c1');
  }

  function getImageData(width, height) {
    var c = getCanvas();
    c.width = width;
    c.height = height;
    var ctx = c.getContext("2d");
    return ctx.getImageData(0,0,width,height);
  }

  function main() {
    loader.loadImage(
        'http://localhost:8989/bigimage.jpeg',
        1024,
        1024,
        function(data, numComponents, width, height) {
      var imageData = getImageData(width, height);
      new CopyImageDataTask(data, numComponents, imageData, function() {
        var start = Date.now();
        getCanvas().getContext('2d').putImageData(imageData, 0, 0);
      });
    });
  }
</script>
</head>
<body onload="main()">
  <canvas id="c1"></canvas><br />
</body></html>
